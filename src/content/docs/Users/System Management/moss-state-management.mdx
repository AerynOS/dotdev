---
title: Manage Moss States and Packages
lastUpdated: 2026-02-20T13:33:00Z
description: Learn how to inspect and switch states, search for software, and keep an AerynOS system up to date with moss.
---

Moss keeps track of packaging-related operations that change the state of the /usr directory by creating a new filesystem transaction (fstx) for each associated moss operation, be it package installation, removal or upgrades. 

Use the commands below to inspect and manage those states, discover software, and keep your system current.

## Check the current state

1. List the active state to confirm what is running right now.

```bash
moss state active
```

2. Review the state history when you need context for a rollback.

```bash
moss state list
```

Use the state ID (the number after `State #`) when you need to query or activate a specific snapshot.

## Activate a different state

Follow these steps to roll back or advance to another state safely.

1. Identify the target state ID with `moss state list`.
2. Activate that state.

```bash
sudo moss state activate 128
```

3. Verify the change.

```bash
moss state active
```

Activating a state atomically swaps the currently active state's /usr directory with the new states's /usr directory, using the Linux kernel [`renameat2` syscall](https://www.man7.org/linux/man-pages/man2/rename.2.html).

On successful activation of the new state, it is recommended to reboot the system, so that long-running services start with the expected binaries, libraries, and configurations.

## Search for packages

Use keyword searches to discover software by name or summary.

```bash
sudo moss search fractional
```

Add `--installed` (`-i`) if you only want to search software that is already present on the system.

## Search for installed files

Look up which package delivered a specific file when you troubleshoot or audit an installation.

```bash
sudo moss search-file libEGL.so
```

`moss search-file` scans files from installed packages only.

## Fetch package stones

Use `moss fetch` to download one or more package `.stone` files by name without installing them on the current system.

```bash
moss fetch howdy-git
```

Fetch multiple packages into a custom output directory:

```bash
moss fetch howdy-git fractional --output-dir ~/stones
```

`moss fetch` writes downloaded files to the current directory by default. Add `--verbose` when you need more detailed progress output.
If a package cannot be resolved, refresh repository metadata and try again:

## Install software

1. Refresh repository metadata when needed.

```bash
sudo moss repo update
```

2. Install one or more packages.

```bash
sudo moss install howdy-git
```

Moss creates a new state automatically. Confirm success with `moss state active`.

## Update the system

Keep the entire system current with a sync operation.

```bash
sudo moss sync --update
```

`--update` (`-u`) pulls fresh repository metadata before applying upgrades. Moss records the result as a new state, so you can roll back if something goes wrong.

## Remove software

Uninstall packages you no longer need.

```bash
sudo moss remove howdy-git
```

Moss snapshots the removal in a new state. Use `moss state list` to find the previous state if you have to recover.

## List currently installed software


```bash
moss list installed
```
